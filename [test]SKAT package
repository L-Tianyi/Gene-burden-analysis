#language: R#
install.packages("SKAT")

#load the example data file#
library(SKAT)
data(SKAT.example)
names(SKAT.example)
attach(SKAT.example)

#analyse using the example data#
obj<-SKAT_Null_Model(y.c ~ X, out_type="C")
SKAT(Z,obj)$p.value

#analyse using some other data#
load("C:\\Users\\ltian\\Desktop\\BIOL0050\\assigment1\\snps.RData")
load("C:\\Users\\ltian\\Desktop\\BIOL0050\\assigment1\\mat.gtex.RData")

genotypes <- snps
expression <- mat.gtex
expression <- expression[,1]
covariates <- SKAT.example[["X"]]
covariates <- covariates[1:53,]

obj1<-SKAT_Null_Model(expression ~ covariates, out_type="C")
SKAT(genotypes,obj1)$p.value
#Genotypes of some variants are not the number of minor alleles! These genotypes are flipped!
